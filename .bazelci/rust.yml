rust_common: &rust_common
  name: "Basic Rust example"
  working_directory: .
  build_targets:
    - "//..."

rust_windows_run_targets: &rust_windows_run_targets
  run_targets:
    - "//:hello_world"
    # Buildifier rules do not work on Windows and Bzlmod
    # https://github.com/keith/buildifier-prebuilt/issues/99
    # https://github.com/bazelbuild/bazel-central-registry/issues/380
    # - "//:buildifier"

rust_unix_run_targets: &rust_unix_run_targets
  run_targets:
    - "//:hello_world"
    - "//:buildifier"

tasks:
  cpp-ubuntu2004:
    platform: ubuntu2004
    <<: *rust_common
    <<: *rust_unix_run_targets
  cpp-ubuntu2204:
    platform: ubuntu2204
    <<: *rust_common
    <<: *rust_unix_run_targets
  cpp-ubuntu2404:
    platform: ubuntu2404
    <<: *rust_common
    <<: *rust_unix_run_targets
  cpp-centos7:
    platform: centos7_java11_devtoolset10
    <<: *rust_common
    <<: *rust_unix_run_targets
  cpp-debian10:
    platform: debian10
    <<: *rust_common
    <<: *rust_unix_run_targets
  cpp-debian11:
    platform: debian11
    <<: *rust_common
    <<: *rust_unix_run_targets
  cpp-macos:
    platform: macos
    <<: *rust_common
    <<: *rust_unix_run_targets
  cpp-windows:
    platform: windows
    <<: *rust_common
    <<: *rust_windows_run_targets
