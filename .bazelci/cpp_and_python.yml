common: &common
  name: "Bazel Macros: Generate cpp files using Python"
  working_directory: .
  build_targets:
    - "//..."

windows_run_targets: &windows_run_targets
  run_targets:
    - "//:hello_world_everyone"
    - "//:hello_world_code_dive"
    # Buildifier rules do not work on Windows and Bzlmod
    # https://github.com/keith/buildifier-prebuilt/issues/99
    # https://github.com/bazelbuild/bazel-central-registry/issues/380
    # - "//:buildifier"

unix_run_targets: &unix_run_targets
  run_targets:
    - "//:hello_world_everyone"
    - "//:hello_world_code_dive"
    - "//:buildifier"

tasks:
  ubuntu2004:
    <<: *common
    <<: *unix_run_targets
  ubuntu2204:
    <<: *common
    <<: *unix_run_targets
  ubuntu2404:
    <<: *common
    <<: *unix_run_targets
  centos7_java11_devtoolset10:
    <<: *common
    <<: *unix_run_targets
  debian10:
    <<: *common
    <<: *unix_run_targets
  debian11:
    <<: *common
    <<: *unix_run_targets
  macos:
    <<: *common
    <<: *unix_run_targets
  windows:
    <<: *common
    <<: *windows_run_targets
